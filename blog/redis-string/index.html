<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="default-src 'self';font-src 'self' data:;img-src 'self' https://* data:;media-src 'self';style-src 'self';frame-src player.vimeo.com https://www.youtube-nocookie.com;connect-src 'self';script-src 'self' 'self'" http-equiv=Content-Security-Policy><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://bieyuanxi.github.io name=base><title>
Terra's Blog • Redis String</title><link title="Terra's Blog - Atom Feed" href=https://bieyuanxi.github.io/atom.xml rel=alternate type=application/atom+xml><link href="https://bieyuanxi.github.io/custom_subset.css?h=0b9535a28bc3d5bf2321" rel=stylesheet><link href="https://bieyuanxi.github.io/main.css?h=045c365e19a4d50a64bb" rel=stylesheet><meta content="light dark" name=color-scheme><meta content="Redis string can be anything!" name=description><meta content="Redis string can be anything!" property=og:description><meta content="Redis String" property=og:title><meta content=article property=og:type><meta content=en_GB property=og:locale><meta content=https://bieyuanxi.github.io/blog/redis-string/ property=og:url><meta content="Terra's Blog" property=og:site_name><noscript><link href=https://bieyuanxi.github.io/no_js.css rel=stylesheet></noscript><script src=https://bieyuanxi.github.io/js/initializeTheme.min.js></script><script defer src=https://bieyuanxi.github.io/js/themeSwitcher.min.js></script><script src="https://bieyuanxi.github.io/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><a href=#main-content id=skip-link>Skip to content</a><header><nav class=navbar><div class=nav-title><a class=home-title href=https://bieyuanxi.github.io/>Terra's Blog</a></div><div class=nav-navs><ul><li><a class="nav-links no-hover-padding" href=https://bieyuanxi.github.io/blog/>blog </a><li><a class="nav-links no-hover-padding" href=https://bieyuanxi.github.io/archive/>archive </a><li><a class="nav-links no-hover-padding" href=https://bieyuanxi.github.io/tags/>tags </a><li><a class="nav-links no-hover-padding" href=https://bieyuanxi.github.io/projects/>projects </a><li class=menu-icons-container><ul class=menu-icons-group><li class="js menu-icon"><div aria-label="Click or press $SHORTCUT to open search" class="search-icon interactive-icon" title="Click or press $SHORTCUT to open search" id=search-button role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><li class="theme-switcher-wrapper js"><div aria-label="Toggle dark mode" title="Toggle dark/light mode" aria-pressed=false class=theme-switcher role=button tabindex=0></div><div aria-label="Reset mode to default" class="theme-resetter arrow" title="Reset mode to default" aria-hidden=true role=button tabindex=0></div></ul></ul></div></nav></header><div class=content id=main-content><main><article class=h-entry><h1 class="p-name article-title">Redis String</h1><a class="u-url u-uid" href=https://bieyuanxi.github.io/blog/redis-string/></a><ul class=meta><span class="hidden p-author h-card"> <a class=u-url href=https://bieyuanxi.github.io rel=author title=Terra>Terra</a> </span><li><time class=dt-published datetime=2026-01-28>28th Jan 2026</time><li title="2064 words"><span aria-hidden=true class=separator>•</span>11 min read<li class=tag><span aria-hidden=true class=separator>•</span>Tags: <li class=tag><a class=p-category href=https://bieyuanxi.github.io/tags/redis/>redis</a>, <li class=tag><a class=p-category href=https://bieyuanxi.github.io/tags/valkey/>valkey</a>, <li class=tag><a class=p-category href=https://bieyuanxi.github.io/tags/string/>string</a></ul><p class=p-summary hidden>Redis string can be anything!<section class="e-content body"><h1 id=can-kao-zi-liao>参考资料</h1><ul><li><a href=https://valkey.io/commands/#string rel=external>valkey commands: string</a></ul><h1 id=ke-yong-ming-ling>可用命令</h1><p>String Operations on the String data type<ul><li>APPEND Appends a string to the value of a key. Creates the key if it doesn’t exist.<li>DECR Decrements the integer value of a key by one. Uses 0 as initial value if the key doesn’t exist.<li>DECRBY Decrements a number from the integer value of a key. Uses 0 as initial value if the key doesn’t exist.<li>DELIFEQ Delete key if value matches string.<li>GET Returns the string value of a key.<li>GETDEL Returns the string value of a key after deleting the key.<li>GETEX Returns the string value of a key after setting its expiration time.<li>GETRANGE Returns a substring of the string stored at a key.<li>GETSET Returns the previous string value of a key after setting it to a new value.<li>INCR Increments the integer value of a key by one. Uses 0 as initial value if the key doesn’t exist.<li>INCRBY Increments the integer value of a key by a number. Uses 0 as initial value if the key doesn’t exist.<li>INCRBYFLOAT Increment the floating point value of a key by a number. Uses 0 as initial value if the key doesn’t exist.<li>LCS Finds the longest common substring.<li>MGET Atomically returns the string values of one or more keys.<li>MSET Atomically creates or modifies the string values of one or more keys.<li>MSETNX Atomically modifies the string values of one or more keys only when all keys don’t exist.<li>PSETEX Sets both string value and expiration time in milliseconds of a key. The key is created if it doesn’t exist.<li>SET Sets the string value of a key, ignoring its type. The key is created if it doesn’t exist.<li>SETEX Sets the string value and expiration time of a key. Creates the key if it doesn’t exist.<li>SETNX Set the string value of a key only when the key doesn’t exist.<li>SETRANGE Overwrites a part of a string value with another by an offset. Creates the key if it doesn’t exist.<li>STRLEN Returns the length of a string value.<li>SUBSTR Returns a substring from a string value.</ul><h2 id=set>SET</h2><p>将键 <code>key</code> 的值设为指定字符串 <code>value</code>。若该键已存有值，则无论原数据类型如何，都会被直接覆盖。默认情况下，当 <code>SET</code> 命令执行成功时，该键原本关联的生存时间（<code>TTL</code>）也会被清除。<p>命令变种：<code>SETEX</code>，<code>SETNX</code>，<code>PSETEX</code>，<code>GETSET</code>。<h3 id=yu-fa>语法</h3><pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">SET</span><span class=z-string> key value</span><span> [</span><span class=z-string> NX</span><span class="z-keyword z-operator"> |</span><span class="z-entity z-name z-function"> XX</span><span class="z-keyword z-operator"> |</span><span class="z-entity z-name z-function"> IFEQ</span><span class=z-string> comparison-value ]</span><span> [</span><span class=z-string> GET ]</span><span> [</span><span class=z-string> EX seconds</span><span class="z-keyword z-operator"> |</span><span class="z-entity z-name z-function"> PX</span><span class=z-string> milliseconds</span><span class="z-keyword z-operator"> |</span><span class="z-entity z-name z-function"> EXAT</span><span class=z-string> unix-time-seconds</span><span class="z-keyword z-operator"> |</span><span class="z-entity z-name z-function"> PXAT</span><span class=z-string> unix-time-milliseconds</span><span class="z-keyword z-operator"> |</span><span class="z-entity z-name z-function"> KEEPTTL</span><span class=z-string> ]</span><span> </span></span></code></pre><p>SET 命令支持一组可修改其行为的选项，具体如下：<ul><li>EX seconds —— 设置键的过期时间，单位为秒（需传入正整数）。<li>PX milliseconds —— 设置键的过期时间，单位为毫秒（需传入正整数）。<li>EXAT timestamp-seconds —— 设置键的过期 Unix 时间戳，单位为秒（需传入正整数）。<li>PXAT timestamp-milliseconds —— 设置键的过期 Unix 时间戳，单位为毫秒（需传入正整数）。<li>NX —— 仅当键不存在时，才执行设置操作。<li>XX —— 仅当键已存在时，才执行设置操作。<li>IFEQ comparison-value —— 仅当键的现有值与指定的比对值完全匹配时，才执行设置操作。若键存储的值并非字符串类型，则返回错误并终止 SET 命令的执行。<li>KEEPTTL —— 保留该键原本关联的生存时间（TTL），不会因设置新值而清空过期时间。<li>GET —— 返回键原本存储的旧字符串值；若键不存在，则返回 nil。若键存储的值并非字符串(String)类型（例如存的是列表、哈希），则返回错误并终止 SET 命令的执行。</ul><h3 id=yong-li>用例</h3><pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> SET mykey "Hello"</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">OK</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> GET mykey</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">"Hello"</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span class=z-comment># Set a value and an expiry time.</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> SET anotherkey "will expire in a minute" EX</span><span class="z-constant z-numeric"> 60</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">OK</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span class=z-comment># Conditionally set a value.</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> SET foo "Initial Value"</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">OK</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> GET foo</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">"Initial Value"</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> SET foo "New Value" IFEQ "Initial Value"</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">OK</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> GET foo</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">"New Value"</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span class=z-comment># 分布式锁，key是资源名称，value是锁持有者随机生成的token，释放锁时客户端应该检查确认是自己生成的锁再释放</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">localhost:6379</span><span>></span><span class=z-string> SET res_lock a-random-token NX</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">OK</span></span>
<span class=giallo-l></span></code></pre><h2 id=setex>SETEX</h2><pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">SETEX</span><span class=z-string> key seconds value</span><span> </span></span>
<span class=giallo-l><span class="z-entity z-name z-function">等价于</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">SET</span><span class=z-string> key value EX seconds</span></span></code></pre><h2 id=setnx>SETNX</h2><p><strong>SET</strong> if <strong>N</strong>ot e<strong>X</strong>ists.<pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">SETNX</span><span class=z-string> key value</span><span> </span></span></code></pre><h3 id=yong-li-1>用例</h3><pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> SETNX mykey "Hello"</span></span>
<span class=giallo-l><span>(</span><span class="z-entity z-name z-function">integer</span><span>)</span><span class="z-entity z-name z-function"> 1</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> SETNX mykey "World"</span></span>
<span class=giallo-l><span>(</span><span class="z-entity z-name z-function">integer</span><span>)</span><span class="z-entity z-name z-function"> 0</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> GET mykey</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">"Hello"</span></span></code></pre><h2 id=setrange>SETRANGE</h2><p>覆盖键key中存储的字符串的指定部分：从指定偏移量开始，以待写入值value的完整长度为覆盖范围完成写入。若指定的偏移量大于键对应字符串的当前长度，会自动用空字节（0 字节） 填充字符串至该偏移量的位置，以匹配写入起始位置；不存在的键会被视作空字符串，因此本命令会自动扩展该键对应的字符串长度，确保能在指定偏移量处写入value。<p>注意：可设置的最大偏移量为 2^29 - 1（即 536870911），这是因为 Valkey 中字符串类型的大小上限为 512MB。若需要写入的数据超出该长度限制，可通过多个键分片存储来实现。<blockquote><p>Patterns: 借助 SETRANGE 及其同类型的 GETRANGE 命令，可以将 Valkey 字符串当作支持 O (1) 随机访问的线性数组来使用。在诸多实际业务场景中，这都是一种极快且高效的存储方式。</blockquote><pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">SETRANGE</span><span class=z-string> key offset value</span><span> </span></span></code></pre><h3 id=yong-li-2>用例</h3><pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> SET key1 "Hello World"</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">OK</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> SETRANGE key1</span><span class="z-constant z-numeric"> 6</span><span class=z-string> "Valkey"</span></span>
<span class=giallo-l><span>(</span><span class="z-entity z-name z-function">integer</span><span>)</span><span class="z-entity z-name z-function"> 12</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> GET key1</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">"Hello Valkey"</span></span>
<span class=giallo-l></span>
<span class=giallo-l><span class=z-comment># zero padding</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> SETRANGE key2</span><span class="z-constant z-numeric"> 6</span><span class=z-string> "Valkey"</span></span>
<span class=giallo-l><span>(</span><span class="z-entity z-name z-function">integer</span><span>)</span><span class="z-entity z-name z-function"> 12</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> GET key2</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">"\x00\x00\x00\x00\x00\x00Valkey"</span></span></code></pre><h2 id=mset>MSET</h2><p>将指定的多个键分别设为对应的取值。MSET 会像普通的 SET 命令一样，用新值覆盖键的原有值；若你不想覆盖已有值，可使用 MSETNX 命令。 MSET 是<strong>原子操作</strong>，因此所有指定的键会被一次性完成赋值。客户端不会出现「部分键已更新、其余键仍保持原值」的中间可见状态。<pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">MSET</span><span class=z-string> key value</span><span> [</span><span class=z-string> key value ... ]</span><span> </span></span></code></pre><h3 id=yong-li-3>用例</h3><pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> MSET key1 "Hello" key2 "World"</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">OK</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> GET key1</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">"Hello"</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> GET key2</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">"World"</span></span></code></pre><h2 id=get>GET</h2><p>获取key对应的值。如果键不存在，返回<code>nil</code>。如果值不是string类型，返回错误。GET 是纯<strong>读命令</strong>，不会修改键的任何元数据（包括过期时间）。<h3 id=yong-li-4>用例</h3><pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> GET nonexisting</span></span>
<span class=giallo-l><span>(</span><span class="z-entity z-name z-function">nil</span><span>)</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> SET mykey "Hello"</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">OK</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> GET mykey</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">"Hello"</span></span></code></pre><h2 id=getex>GETEX</h2><p>获取键 key 对应的取值，并可按需为该键设置过期时间。GETEX 命令与 GET 命令功能相近，区别在于它属于<strong>写命令</strong>，即使仅使用 GETEX key（不带任何选项），也会触发 Redis 对键的访问时间更新（影响 LRU 淘汰策略），且会同步到主从节点 / AOF 日志。<h3 id=yu-fa-1>语法</h3><pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">GETEX</span><span class=z-string> key</span><span> [</span><span class=z-string> EX seconds</span><span class="z-keyword z-operator"> |</span><span class="z-entity z-name z-function"> PX</span><span class=z-string> milliseconds</span><span class="z-keyword z-operator"> |</span><span class="z-entity z-name z-function"> EXAT</span><span class=z-string> unix-time-seconds</span><span class="z-keyword z-operator"> |</span><span class="z-entity z-name z-function"> PXAT</span><span class=z-string> unix-time-milliseconds</span><span class="z-keyword z-operator"> |</span><span class="z-entity z-name z-function"> PERSIST</span><span class=z-string> ]</span><span> </span></span></code></pre><p>GETEX 命令支持一组可修改其行为的选项，具体如下：<ul><li>PERSIST —— 移除该键关联的生存时间（TTL），使其变为永久有效。</ul><h3 id=yong-li-5>用例</h3><pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> SET mykey "Hello"</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">OK</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> GETEX mykey</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">"Hello"</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> TTL mykey</span></span>
<span class=giallo-l><span>(</span><span class="z-entity z-name z-function">integer</span><span>)</span><span class="z-entity z-name z-function"> -1</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> GETEX mykey EX</span><span class="z-constant z-numeric"> 60</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">"Hello"</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> TTL mykey</span></span>
<span class=giallo-l><span>(</span><span class="z-entity z-name z-function">integer</span><span>)</span><span class="z-entity z-name z-function"> 60</span></span></code></pre><h2 id=getdel>GETDEL</h2><p>获取键key的值并删除该键。此命令与GET命令功能相近，区别在于：执行成功时会同时删除该键（当且仅当该键的值类型为字符串类型时，才会执行删除操作）。<h3 id=yu-fa-2>语法</h3><pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">GETDEL</span><span class=z-string> key</span><span> </span></span></code></pre><h3 id=yong-li-6>用例</h3><pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> SET mykey "Hello"</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">OK</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> GETDEL mykey</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">"Hello"</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> GET mykey</span></span>
<span class=giallo-l><span>(</span><span class="z-entity z-name z-function">nil</span><span>)</span></span></code></pre><h2 id=getrange>GETRANGE</h2><p>返回存储在指定键<code>key</code>中的字符串值的子串，子串范围由偏移量 <code>start</code> 和 <code>end</code> 决定（两个偏移量对应的字符均包含在内）。可以使用负数偏移量，表示从字符串的末尾开始计算位置。例如，<code>-1</code> 代表最后一个字符，<code>-2</code> 代表倒数第二个字符，以此类推。该函数会通过将结果范围限制在字符串的实际长度内，来处理超出范围的请求。<h3 id=yu-fa-3>语法</h3><pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">GETRANGE</span><span class=z-string> key start end</span><span> </span></span></code></pre><h3 id=shi-jian-fu-za-du>时间复杂度</h3><p><code>O(N)</code>，<code>N</code>是返回子串的大小，子串较小时可以近似认为是<code>O(1)</code>。<h3 id=yong-li-7>用例</h3><pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> SET mykey "This is a string"</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">OK</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> GETRANGE mykey</span><span class="z-constant z-numeric"> 0 3</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">"This"</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> GETRANGE mykey</span><span class="z-constant z-other z-option"> -3 -1</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">"ing"</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> GETRANGE mykey</span><span class="z-constant z-numeric"> 0</span><span class="z-constant z-other z-option"> -1</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">"This is a string"</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> GETRANGE mykey</span><span class="z-constant z-numeric"> 10 100</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">"string"</span></span>
<span class=giallo-l><span class=z-comment># 右边界在左边界左边，返回空子串</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">localhost:6379</span><span>></span><span class=z-string> GETRANGE mykey</span><span class="z-constant z-numeric"> 5 0</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">""</span></span></code></pre><h2 id=getset>GETSET</h2><p>以<strong>原子操作</strong>的方式将键 key 的值设为 value，并返回该键原本存储的值。若键已存在但存储的并非字符串类型，则返回错误。当 SET 命令执行成功时，该键原本关联的所有生存时间（TTL）都会被清除。<h3 id=yu-fa-4>语法</h3><pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">GETSET</span><span class=z-string> key value</span><span> </span></span>
<span class=giallo-l><span class=z-comment># 等价于</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">SET</span><span class=z-string> key value GET</span></span></code></pre><h3 id=yong-li-8>用例</h3><p>GETSET 可与 INCR 配合使用，实现<strong>原子化重置</strong>的计数功能。例如：某进程可在每次有事件发生时，对键 mycounter 执行 INCR 命令（累加计数）；但我们需要不定期地原子性地获取计数器当前值，并将其重置为 0，这一操作可通过执行 GETSET mycounter “0” 实现。<pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> INCR mycounter</span></span>
<span class=giallo-l><span>(</span><span class="z-entity z-name z-function">integer</span><span>)</span><span class="z-entity z-name z-function"> 1</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> GETSET mycounter "0"</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">"1"</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> GET mycounter</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">"0"</span></span></code></pre><h2 id=mget>MGET</h2><p>返回所有指定键对应的值。对于非字符串类型或不存在的键，均返回特殊值 <code>nil</code>。正因如此，该操作永远不会执行失败。<pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">MGET</span><span class=z-string> key</span><span> [</span><span class=z-string> key ... ]</span><span> </span></span></code></pre><h3 id=yong-li-9>用例</h3><pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> SET key1 "Hello"</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">OK</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> SET key2 "World"</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">OK</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> MGET key1 key2 nonexisting</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">1</span><span>) </span><span class=z-string>"Hello"</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">2</span><span>) </span><span class=z-string>"World"</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">3</span><span>) (</span><span class="z-entity z-name z-function">nil</span><span>)</span></span></code></pre><h2 id=delifeq>DELIFEQ</h2><blockquote><p>Since: 9.0.0</blockquote><pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">DELIFEQ</span><span class=z-string> key value</span><span> </span></span></code></pre><p>仅当键的值与指定字符串完全匹配时，才删除该键。 此命令通常用于分布式系统中安全释放锁，确保只有锁的持有者（通过值来标识）能够删除该锁。 若键存在，且存储的字符串值与传入值完全一致，则删除该键并返回1；否则，键保持不变并返回0。<h3 id=yong-li-10>用例</h3><pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> SET mykey abc123</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">OK</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> DELIFEQ mykey abc123</span></span>
<span class=giallo-l><span>(</span><span class="z-entity z-name z-function">integer</span><span>)</span><span class="z-entity z-name z-function"> 1</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> DELIFEQ mykey abc123</span></span>
<span class=giallo-l><span>(</span><span class="z-entity z-name z-function">integer</span><span>)</span><span class="z-entity z-name z-function"> 0</span></span></code></pre><h2 id=incr>INCR</h2><p>将存储在键 key 中的数字值自增 1。若该键不存在，则会先将其值设为 0，再执行自增操作。若键中存储的值类型错误（非字符串），或存储的字符串无法解析为整数，则返回错误。此操作仅支持<strong>64 位有符号整数</strong>。<p>注意：这是一个字符串操作，因为 Valkey 并不具备专用的整数类型。执行此操作时，键中存储的字符串会被解析为10 进制的 64 位有符号整数。 Valkey 会以整数的原生存储格式来保存整数值，因此对于那些实际存储整数的字符串值来说，并不会产生存储整数字符串表示形式的额外开销。<h3 id=yong-li-11>用例</h3><pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> SET mykey "10"</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">OK</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> INCR mykey</span></span>
<span class=giallo-l><span>(</span><span class="z-entity z-name z-function">integer</span><span>)</span><span class="z-entity z-name z-function"> 11</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">127.0.0.1:6379</span><span>></span><span class=z-string> GET mykey</span></span>
<span class=giallo-l><span class="z-entity z-name z-function">"11"</span></span></code></pre><h2 id=incrby>INCRBY</h2><pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">INCRBY</span><span class=z-string> key increment</span><span> </span></span></code></pre><h2 id=decr>DECR</h2><pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">DECR</span><span class=z-string> key</span><span> </span></span></code></pre><h2 id=decrby>DECRBY</h2><pre class="giallo z-code"><code data-lang=shellscript><span class=giallo-l><span class="z-entity z-name z-function">DECRBY</span><span class=z-string> key decrement</span><span> </span></span></code></pre></section></article></main><div id=button-container><div id=toc-floating-container><input class=toggle id=toc-toggle type=checkbox><label title="Toggle Table of Contents" class=button for=toc-toggle id=toc-button><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M414.82-193.094q-18.044 0-30.497-12.32-12.453-12.319-12.453-30.036t12.453-30.086q12.453-12.37 30.497-12.37h392.767q17.237 0 29.927 12.487 12.69 12.486 12.69 30.203 0 17.716-12.69 29.919t-29.927 12.203H414.82Zm0-244.833q-18.044 0-30.497-12.487Q371.87-462.9 371.87-480.45t12.453-29.92q12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.511 12.69 12.512 12.69 29.845 0 17.716-12.69 30.086-12.69 12.37-29.927 12.37H414.82Zm0-245.167q-18.044 0-30.497-12.32t-12.453-30.037q0-17.716 12.453-30.086 12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.486 12.69 12.487 12.69 30.203 0 17.717-12.69 29.92-12.69 12.203-29.927 12.203H414.82ZM189.379-156.681q-32.652 0-55.878-22.829t-23.226-55.731q0-32.549 23.15-55.647 23.151-23.097 55.95-23.097 32.799 0 55.313 23.484 22.515 23.484 22.515 56.246 0 32.212-22.861 54.893-22.861 22.681-54.963 22.681Zm0-245.167q-32.652 0-55.878-23.134-23.226-23.135-23.226-55.623 0-32.487 23.467-55.517t56.12-23.03q32.102 0 54.721 23.288 22.62 23.288 22.62 55.775 0 32.488-22.861 55.364-22.861 22.877-54.963 22.877Zm-.82-244.833q-32.224 0-55.254-23.288-23.03-23.289-23.03-55.623 0-32.333 23.271-55.364 23.272-23.03 55.495-23.03 32.224 0 55.193 23.288 22.969 23.289 22.969 55.622 0 32.334-23.21 55.364-23.21 23.031-55.434 23.031Z"/></svg></label><div class=toc-content><div class=toc-container><ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#can-kao-zi-liao>参考资料</a><li><a href=https://bieyuanxi.github.io/blog/redis-string/#ke-yong-ming-ling>可用命令</a> <ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#set>SET</a> <ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#yu-fa>语法</a><li><a href=https://bieyuanxi.github.io/blog/redis-string/#yong-li>用例</a></ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#setex>SETEX</a><li><a href=https://bieyuanxi.github.io/blog/redis-string/#setnx>SETNX</a> <ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#yong-li-1>用例</a></ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#setrange>SETRANGE</a> <ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#yong-li-2>用例</a></ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#mset>MSET</a> <ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#yong-li-3>用例</a></ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#get>GET</a> <ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#yong-li-4>用例</a></ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#getex>GETEX</a> <ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#yu-fa-1>语法</a><li><a href=https://bieyuanxi.github.io/blog/redis-string/#yong-li-5>用例</a></ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#getdel>GETDEL</a> <ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#yu-fa-2>语法</a><li><a href=https://bieyuanxi.github.io/blog/redis-string/#yong-li-6>用例</a></ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#getrange>GETRANGE</a> <ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#yu-fa-3>语法</a><li><a href=https://bieyuanxi.github.io/blog/redis-string/#shi-jian-fu-za-du>时间复杂度</a><li><a href=https://bieyuanxi.github.io/blog/redis-string/#yong-li-7>用例</a></ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#getset>GETSET</a> <ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#yu-fa-4>语法</a><li><a href=https://bieyuanxi.github.io/blog/redis-string/#yong-li-8>用例</a></ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#mget>MGET</a> <ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#yong-li-9>用例</a></ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#delifeq>DELIFEQ</a> <ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#yong-li-10>用例</a></ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#incr>INCR</a> <ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#yong-li-11>用例</a></ul><li><a href=https://bieyuanxi.github.io/blog/redis-string/#incrby>INCRBY</a><li><a href=https://bieyuanxi.github.io/blog/redis-string/#decr>DECR</a><li><a href=https://bieyuanxi.github.io/blog/redis-string/#decrby>DECRBY</a></ul></ul></div></div></div><a title="Go to the top of the page" class=no-hover-padding href=# id=top-button> <svg viewbox="0 0 20 20" fill=currentColor><path d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z"/></svg> </a></div><span class=hidden id=copy-success> Copied! </span><span class=hidden id=copy-init> Copy code to clipboard </span><script defer src=https://bieyuanxi.github.io/js/copyCodeToClipboard.min.js></script></div><footer><section><nav class="socials nav-navs"><ul><li><a class="nav-links no-hover-padding social" href=https://bieyuanxi.github.io/atom.xml> <img alt=feed loading=lazy src=https://bieyuanxi.github.io/social_icons/rss.svg title=feed> </a></ul></nav><nav class=nav-navs></nav><div class=credits><small> Powered by <a href=https://www.getzola.org>Zola</a> & <a href=https://github.com/welpo/tabi>tabi</a> </small></div></section><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><h1 class=visually-hidden id=modalTitle>Search</h1><div id=modal-content><div id=searchBar><div aria-hidden=true class=search-icon><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search… role=combobox spellcheck=false><div class="close-icon interactive-icon" title="Clear search" id=clear-search role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></div></div><div id=results-container><div id=results-info><span id=zero_results> No results</span><span id=one_results> $NUMBER result</span><span id=many_results> $NUMBER results</span><span id=two_results> $NUMBER results</span><span id=few_results> $NUMBER results</span></div><div id=results role=listbox></div></div></div></div></footer>